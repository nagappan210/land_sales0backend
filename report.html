<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Report Form</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center">

  <div class="w-full max-w-md bg-white p-6 rounded-2xl shadow-lg">
    <h2 class="text-2xl font-bold text-gray-800 mb-4 text-center">Report Form</h2>
    
    <form id="reportForm" class="space-y-4">
      <!-- User ID -->
      <div>
        <label for="user_id" class="block text-sm font-medium text-gray-700">Your User ID</label>
        <input type="number" id="user_id" name="user_id" required
          class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm p-2">
      </div>

      <!-- Receiver ID -->
      <div>
        <label for="receiver_id" class="block text-sm font-medium text-gray-700">Receiver User ID</label>
        <input type="number" id="receiver_id" name="receiver_id" required
          class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm p-2">
      </div>

      <!-- Post ID -->
      <div>
        <label for="user_post_id" class="block text-sm font-medium text-gray-700">Post ID (if reporting a post)</label>
        <input type="number" id="user_post_id" name="user_post_id"
          class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm p-2">
      </div>

      <!-- Status -->
      <div>
        <label for="status" class="block text-sm font-medium text-gray-700">Report Type</label>
        <select id="status" name="status" required
          class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm p-2">
          <option value="1">Report User</option>
          <option value="2">Report Post</option>
        </select>
      </div>

      <!-- Submit -->
      <button type="submit"
        class="w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
        Submit Report
      </button>
    </form>

    <!-- Message -->
    <div id="messageBox" class="hidden mt-4 p-3 rounded-lg text-center"></div>
  </div>

  <script>
    document.getElementById('reportForm').addEventListener('submit', async (e) => {
      e.preventDefault();

      const data = {
        user_id: document.getElementById('user_id').value,
        receiver_id: document.getElementById('receiver_id').value,
        user_post_id: document.getElementById('user_post_id').value || null,
        status: document.getElementById('status').value
      };

      try {
        const response = await fetch('http://localhost:7000/report_users', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        const result = await response.json();

        const msgBox = document.getElementById('messageBox');
        msgBox.classList.remove("hidden");

        if (result.result === "1") {
          msgBox.className = "mt-4 p-3 rounded-lg text-center bg-green-100 text-green-700";
          msgBox.textContent = result.message;
        } else {
          msgBox.className = "mt-4 p-3 rounded-lg text-center bg-red-100 text-red-700";
          msgBox.textContent = result.error;
        }
      } catch (err) {
        const msgBox = document.getElementById('messageBox');
        msgBox.classList.remove("hidden");
        msgBox.className = "mt-4 p-3 rounded-lg text-center bg-red-100 text-red-700";
        msgBox.textContent = "Server error. Please try again.";
      }
    });
  </script>
</body>
</html>
